# EIP-7594 PeerDAS - Peer Data Availability Sampling

## TL;DR

PeerDAS (Peer Data Availability Sampling) is a networking protocol that allows nodes to perform data availability sampling (DAS) to ensure that blob data has been made available while downloading only a subset of the data. PeerDAS utilizes gossip for distribution, discovery for finding peers of particular data custody, and peer requests for sampling.

## Requirements

EIP-4844

## Purpose

To enable nodes in Ethereum to verify that blob data (introduced in EIP-4844) is actually available on the network without every node having to download all of the blob data. In short: sampling instead of full download.

## Motivation

EIP-4844 increases data availability by allowing “blob-carrying transactions”, but that comes with bandwidth and storage costs if every node needs to store all blob data. PeerDAS addresses scalability limits by reducing what each node needs to fetch, while maintaining security that data is available.

## Key Technical Features of PeerDAS

- **Sampling Scheme:** Nodes download a small, constant fraction of the data (“cells”/columns across blobs), rather than full blob data. Typically something like 1/8 (i.e. each node only needs to fetch ~12.5%) under current parameters; future targets aim for lower fractions (1/16, 1/32…).
- **Erasure coding / Reed-Solomon(1D) per blob:** blobs are split into “cells” which are extended, so that missing cells can be reconstructed if enough are available. This supports sampling: if enough peers have enough cells, the full blob can be reconstructed.
- **Peer custody / Subnets:** Nodes/custody groups / peers are assigned subsets of the data-columns (“columns” = cross-blob slices) that they are responsible for. They advertise what they custody, so others can sample from them.
- **Cell proofs via KZG commitment scheme:** the blobs are committed via KZG (as in 4844), but now there are proofs that specific “cells” correspond correctly to those commitments. Nodes verify cell proofs when sampling.
- **Backward compatibility:** PeerDAS is designed to be fully compatible with EIP-4844; it works with the blob format introduced there.

## How EIP-7594 Builds on / Extends EIP-4844

Here’s how PeerDAS leverages and extends the foundation laid by 4844:

| Aspect | EIP-4844 (Proto-Danksharding) | What PeerDAS Adds / Improves |
|--------|-------------------------------|-------------------------------|
| **Blob Data Introduction** | Introduced “blob-carrying transactions”: large data chunks (blobs) which are committed via KZG, stored temporarily (~2 weeks) by consensus layer, not accessible to EVM directly. | PeerDAS uses those blobs as the data substrate to apply sampling: instead of requiring full storage, nodes sample small parts of the blobs to check availability. |
| **Data Availability Guarantees** | Ensures blob data is posted, committed, and stored temporarily, but full reconstruction / availability depends on all nodes downloading and storing the entire blob. | Provides a probabilistic mechanism to ensure data availability with less overhead: nodes only need to sample cells from peers, check proofs, and with high probability be confident data is available. |
| **Scalability / Throughput** | Increased maximum blobs per block to boost data throughput for rollups, but scaling is limited by all nodes having to download/store full blobs. | Relaxes that constraint: more blobs per block can be supported because individual nodes need not consume full blob storage/bandwidth. Enables more aggressive scaling of blob throughput. |
| **Trade-offs** | Cheaper rollup data but still heavy requirements for consensus layer nodes (bandwidth, storage) as usage grows. | Introduces probabilistic assurance with negligible failure chance, at the cost of added complexity (peer sampling, erasure coding, cell proofs). |

## Security  / Constraints

- **Withholding Attack:** If a block producer publishes commitments but does not actually make blob data available, PeerDAS’s sampling must detect that. The parameters (how many cells to sample, how many peers, custody groups) are chosen such that the probability of undetected withholding is negligibly small.
- **Poor Connectivity/Coverage:** For sampling to work well, nodes need to have enough peers and peer diversity so that sampled cells cover a sufficient fraction of the data. If peer connections are too few or poorly distributed, coverage suffers.
- **Proof Overhead & Latency:** Building and verifying cell proofs introduces extra computation. There is also some coordination overhead (which peers have which cells), and potentially delay if nodes need to wait or fetch extra data to satisfy sampling.
- **Increased complexity in networking & consensus client behavior:** PeerDAS requires changes in how gossip / P2P distribution works, sidecar subnets or similar, peer advertisement of custody, etc. More moving parts than pure 4844.

## Implications

- **For rollups (especially ZK/Optimism):** ability to post more data at lower cost per unit, hence cheaper L2 commitments / state proofs.
- **For node operators:** reduced storage / bandwidth overhead per node for a given blob throughput (given sampling), meaning better decentralization is maintained even as data demands grow.


